!function(s){woodmartThemeModule.frequentlyBoughtTogether=function(){function r(a){var n={};return a.find(".wd-fbt-product").each(function(){var t=s(this),e=s(this).find("input"),o=t.data("id"),d=a.parents(".wd-fbt");e.length?e.is(":checked")?(t.find(".wd-fbt-product-variation").length?n[o]=t.find(".wd-fbt-product-variation select").val():n[o]="",d.find(".product.post-"+o).removeClass("wd-disabled-fbt")):d.find(".product.post-"+o).addClass("wd-disabled-fbt"):t.find(".wd-fbt-product-variation").length?n[o]=t.find(".wd-fbt-product-variation select").val():n[o]=""}),n}s("form.wd-fbt-form").each(function(){var n="",i=s(this);i.on("change",".wd-fbt-product input, .wd-fbt-product select",function(){var t=s(this),a=r(i),e=i.find("input[name=wd-fbt-main-product]").val(),o=i.find(".wd-fbt-purchase-btn");a&&void 0!==a[e]&&(Object.keys(a).length<2?o.addClass("wd-disabled"):o.removeClass("wd-disabled"),e=i.parents(".wd-fbt").find(".owl-carousel"),o=t.parents(".wd-fbt-product").index(),s(e.find(".owl-item")[o]).hasClass("active")||(1===o&&void 0!==e.data("owl.carousel")&&1<e.data("owl.carousel").settings.items&&(o=0),e.trigger("to.owl.carousel",[o,500,!0])),clearTimeout(n),n=setTimeout(function(){var t,e,o,d;e=a,o=(t=i).find("input[name=wd-fbt-main-product]").val(),d=t.find("input[name=wd-fbt-bundle-id]").val(),t.find(".wd-loader-overlay").addClass("wd-loading"),s.ajax({url:woodmart_settings.ajaxurl,data:{action:"woodmart_update_frequently_bought_price",products_id:e,main_product:o,bundle_id:d,key:woodmart_settings.frequently_bought},method:"POST",success:function(t){t.fragments&&s.each(t.fragments,function(t,e){s(t).replaceWith(e)})},error:function(){console.log("ajax error")},complete:function(){t.find(".wd-loader-overlay").removeClass("wd-loading")}})},1e3))}),i.on("click",".wd-fbt-purchase-btn",function(t){t.preventDefault();var e,o,d=s(this);d.hasClass("wd-disabled")||(t=r(i),e=i.find("input[name=wd-fbt-main-product]").val(),o=i.find("input[name=wd-fbt-bundle-id]").val(),t&&void 0!==t[e]&&(clearTimeout(n),d.addClass("loading"),s.ajax({url:woodmart_settings.ajaxurl,data:{action:"woodmart_purchasable_fbt_products",products_id:t,main_product:e,bundle_id:o,key:woodmart_settings.frequently_bought},method:"POST",success:function(t){var e=s(".woocommerce-notices-wrapper");if(e.empty(),t.notices&&0<t.notices.indexOf("error"))return e.append(t.notices),e=e.offset().top-woodmart_settings.ajax_scroll_offset,void s("html, body").stop().animate({scrollTop:e},400);void 0!==t.fragments&&("widget"===woodmart_settings.add_to_cart_action&&s.magnificPopup.close(),d.addClass("added"),woodmartThemeModule.$body.trigger("added_to_cart",[t.fragments,t.cart_hash,""]))},error:function(){console.log("ajax error")},complete:function(){d.removeClass("loading")}})))})})},s(document).ready(function(){woodmartThemeModule.frequentlyBoughtTogether()})}(jQuery);
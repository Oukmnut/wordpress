!function(i){woodmartThemeModule.woodmartCompare=function(){var r="woodmart_compare_list";if(woodmart_settings.is_multisite&&(r+="_"+woodmart_settings.current_blog_id),"undefined"!=typeof Cookies){var e,o=woodmartThemeModule.$body,t=i(".wd-header-compare"),a=Cookies.get(r);if(0<t.length){if(void 0!==a)try{var n=JSON.parse(a);t.find(".wd-tools-count").text(n.length)}catch(e){console.log("cant parse cookies json")}else t.find(".wd-tools-count").text(0);if(void 0!==woodmart_settings.compare_by_category&&"yes"===woodmart_settings.compare_by_category)try{woodmartThemeModule.supports_html5_storage?(e=JSON.parse(sessionStorage.getItem(r+"_fragments")),(e="undefined"==typeof actions||"1"!==actions.is_lang_switched&&"1"!==actions.force_reset?e:"")?i.each(e,function(e,o){i(e).replaceWith(o)}):c()):c()}catch(e){c()}}o.on("click",".wd-compare-btn a",function(e){var o=i(this),t=o.data("id"),a=o.data("added-text");if(o.hasClass("added"))return!0;e.preventDefault(),o.addClass("loading"),jQuery.ajax({url:woodmart_settings.ajaxurl,data:{action:"woodmart_add_to_compare",id:t},dataType:"json",method:"GET",success:function(e){e.table?(s(e),woodmartThemeModule.$document.trigger("added_to_compare"),woodmartThemeModule.$document.trigger("wdUpdateTooltip",o),e.fragments&&(i.each(e.fragments,function(e,o){i(e).replaceWith(o)}),sessionStorage.setItem(r+"_fragments",JSON.stringify(e.fragments)))):console.log("something wrong loading compare data ",e)},error:function(){console.log("We cant add to compare. Something wrong with AJAX response. Probably some PHP conflict.")},complete:function(){o.removeClass("loading").addClass("added"),(0<o.find("span").length?o.find("span"):o).text(a),woodmartThemeModule.$document.trigger("wdUpdateTooltip",o)}})}),o.on("click",".wd-compare-remove",function(e){e.preventDefault();var o=i(this),e=o.data("id"),t="";void 0!==woodmart_settings.compare_by_category&&"yes"===woodmart_settings.compare_by_category&&(t=o.parents(".wd-compare-table").data("category-id"))&&o.parents(".compare-value").siblings().length<=1?d(t,o.parents(".wd-compare-page")):(o.addClass("loading"),jQuery.ajax({url:woodmart_settings.ajaxurl,data:{action:"woodmart_remove_from_compare",id:e,category_id:t,key:woodmart_settings.compare_page_nonce},dataType:"json",method:"GET",success:function(e){e.table?(s(e),e.fragments&&(i.each(e.fragments,function(e,o){i(e).replaceWith(o)}),sessionStorage.setItem(r+"_fragments",JSON.stringify(e.fragments)))):console.log("something wrong loading compare data ",e)},error:function(){console.log("We cant remove product compare. Something wrong with AJAX response. Probably some PHP conflict.")},complete:function(){o.remove("loading")}}))}),o.on("change",".wd-compare-select",function(e){e.preventDefault();var e=i(this),o=e.parents(".wd-compare-page"),t=o.find(".wd-compare-table[data-category-id="+e.val()+"]"),a=o.find(".wd-compare-table.wd-active");o.find(".wd-compare-cat-link").attr("href",t.data("category-url")),a.removeClass("wd-in"),setTimeout(function(){a.removeClass("wd-active")},100),setTimeout(function(){t.addClass("wd-active")},100),setTimeout(function(){t.addClass("wd-in"),woodmartThemeModule.$document.trigger("wood-images-loaded")},200)}),o.on("click",".wd-compare-remove-cat",function(e){e.preventDefault();e=i(this);d(e.parents(".wd-compare-header").find(".wd-compare-select").val(),e.parents(".wd-compare-page"))})}function d(e,o){var t=o.find(".wd-loader-overlay");t.addClass("wd-loading"),jQuery.ajax({url:woodmart_settings.ajaxurl,data:{action:"woodmart_remove_category_from_compare",category_id:e,key:woodmart_settings.compare_page_nonce},dataType:"json",method:"GET",success:function(e){e.table?(s(e),e.fragments&&(i.each(e.fragments,function(e,o){i(e).replaceWith(o)}),sessionStorage.setItem(r+"_fragments",JSON.stringify(e.fragments)))):console.log("something wrong loading compare data ",e)},error:function(){console.log("We cant remove product compare. Something wrong with AJAX response. Probably some PHP conflict.")},complete:function(){t.removeClass("wd-loading");var e=i(".wd-compare-table").first();setTimeout(function(){e.addClass("wd-active")},100),setTimeout(function(){e.addClass("wd-in"),woodmartThemeModule.$document.trigger("wood-images-loaded")},200)}})}function s(e){var o=i(".wd-header-compare");0<o.length&&o.find(".wd-tools-count").text(e.count),woodmartThemeModule.removeDuplicatedStylesFromHTML(e.table,function(e){var o=i(".wd-compare-page"),t=i(".wd-compare-table");0<o.length?o.replaceWith(e):0<t.length&&t.replaceWith(e)}),void 0!==woodmart_settings.compare_by_category&&"yes"===woodmart_settings.compare_by_category&&woodmartThemeModule.$document.trigger("wdTabsInit")}function c(){jQuery.ajax({url:woodmart_settings.ajaxurl,data:{action:"woodmart_get_fragment_product_category_compare"},dataType:"json",method:"GET",success:function(e){e.fragments?(i.each(e.fragments,function(e,o){i(e).replaceWith(o)}),sessionStorage.setItem(r+"_fragments",JSON.stringify(e.fragments))):console.log("something wrong loading compare data ",e)},error:function(){console.log("We cant remove product compare. Something wrong with AJAX response. Probably some PHP conflict.")}})}},i(document).ready(function(){woodmartThemeModule.woodmartCompare()})}(jQuery);